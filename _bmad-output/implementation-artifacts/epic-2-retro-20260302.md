# Retrospective Summary: Epic 2 - Camera Capture & Image Processing

## 1. Overview
**Date:** 2026-03-02
**Epic:** Epic 2: Camera Capture & Image Processing
**Status:** Completed

This retrospective covers the implementation of the camera capture functionality, gallery image picking, native permission handling, and the client-side image compression pipeline.

## 2. Successes & Wins
*   **Clean Implementation:** Successfully implemented a full-screen, minimal camera UI using `expo-camera` that feels native and responsive.
*   **Performance:** The image compression pipeline using `expo-image-manipulator` successfully resizes and compresses captured images to consistently hit the <500KB target required for the backend, maintaining speed (under 2 seconds).
*   **Resiliency:** Native permission handling was implemented gracefully. The integration of an `AppState` listener ensures the app accurately updates its camera view state when a user returns from adjusting permissions in the OS settings.

## 3. Challenges & Roadblocks
*   **Mobile Permissions Nuance:** Handling the different states of mobile permissions (e.g., requested, granted, denied, blocked) proved complex, especially seamlessly returning from OS settings without requiring an app restart.
*   **Image Quality vs Size:** Finding the right balance between resizing dimensions and compression quality factor required iterative testing to ensure the image was small enough for the AI service without degrading visual detail necessary for accurate analysis.
*   **Tooling Choices:** Time was spent evaluating `expo-camera` versus alternatives like `react-native-vision-camera`. While `expo-camera` was selected for current needs, future requirements for real-time frame processing might necessitate a migration.

## 4. Key Takeaways & Learnings
*   **AppState is Crucial for Permissions:** Relying solely on the initial permission request promise is insufficient on mobile. Using `AppState` changes to re-check permission status provides a much smoother UX.
*   **Aggressive Compression Works:** Client-side image manipulation is fast enough on modern devices that we can aggressively compress images before network transit, saving significant bandwidth and speeding up backend AI processing.

## 5. Action Items
1.  **Cloud Native Setup (Epic 3 Prep):** The very first task of Epic 3 must be properly scaffolding the Firebase Functions environment and configuring secret management for the Gemini API key before any function logic is written. *(Owner: Dev Team, Timing: Start of Epic 3)*
2.  **Compression QA:** Monitor image compression execution times on older Android devices during QA to ensure we consistently meet the <2s NFR. Adjust max dimension limits if performance suffers on low-end hardware. *(Owner: QA/Dev, Timing: Ongoing)*
3.  **Future-Proofing Camera:** Keep the `react-native-vision-camera` migration documented as technical debt/future improvement should the app require barcode scanning, text recognition, or live object detection on the client side. *(Owner: Architect, Timing: Backlog)*

## 6. Next Steps
The team is ready to proceed to **Epic 3: AI-Powered Item Analysis**, focusing on backend Cloud Function development and Gemini API integration.
